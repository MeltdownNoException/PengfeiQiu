<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
  <title>测试</title>
</head>
<body>
<!-- 写入数据测试 -->
<div>
<input type="text" id="text">
<input id="1" type="button" value="写入测试文件内容" onclick="test(id)">
</div>
<!-- 读取数据测试 -->
<div>
<input id="2" type="button" value="读取测试文件内容" onclick="test(id)">
</div>
<div id="aa"></div> 


<script language="javascript">
function test(id){
var fso = new ActiveXObject("Scripting.FileSystemObject"); 
if(id== 1){
var text = document.getElementById('text').value;
if(text){
var f = fso.createtextfile("D:\\test.txt",true); 
f.writeLine(text); 
f.close();
alert("写入数据成功...");
}else{
alert("输入内容不能为空...");
}
}else{
var ts, s ; 
var ForReading = 1; 
fso = new ActiveXObject("Scripting.FileSystemObject"); 
ts = fso.OpenTextFile("D:\\test.txt", ForReading); 
s = ts.ReadLine(); 
document.getElementById("aa").innerHTML=s; 
}
}
</script>  
</body>
</html>